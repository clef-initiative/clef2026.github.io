{{ $color := .Site.Params.color | default "stone" }}
{{ $gray := .Site.Params.gray | default "stone" }}

<footer class="
    border-t-4
    border-{{ $gray }}-200
    dark:border-{{ $gray }}-800
    py-4
">
  <div class="md:max-w-2xl max-w-full mx-auto px-4 flex flex-row justify-between items-center gap-4">
    <!-- Element 2: CLEF Initiative Logo -->
    <div class="flex-1">
        <svg class="
          h-32
          cursor-pointer
          max-w-full
          mr-auto
          object-scale-down
        "
        viewBox="0 0 1690 1690" xmlns="http://www.w3.org/2000/svg" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
        <g transform="matrix(0.976331,0,0,0.976331,-24.4331,-24.4231)">
            <g transform="matrix(1.00242,0,0,0.975819,-49.6202,-9.37254)">
                <ellipse cx="937.859" cy="922.172" rx="827.995" ry="850.568" style="fill:rgb(48,50,51);"/>
            </g>
            <g transform="matrix(1.02054,0,0,0.993454,-66.6105,-25.6353)">
                <path d="M937.859,71.604C1394.84,71.604 1765.85,452.731 1765.85,922.172C1765.85,1391.61 1394.84,1772.74 937.859,1772.74C480.876,1772.74 109.864,1391.61 109.864,922.172C109.864,452.731 480.876,71.604 937.859,71.604ZM364.808,974.895L340.585,1220.36L440.727,1220.36L416.552,974.874C440.191,964.515 456.779,940.413 456.779,912.363C456.779,874.875 427.15,844.438 390.656,844.438C354.162,844.438 324.534,874.875 324.534,912.363C324.534,940.433 341.143,964.548 364.808,974.895ZM488.644,268.48L488.644,1234.34C488.644,1250.51 475.863,1263.63 460.121,1263.63L321.191,1263.63C305.449,1263.63 292.669,1250.51 292.669,1234.34L292.669,473.829C208.215,601.763 158.858,756.093 158.858,922.172C158.858,1363.84 507.917,1722.41 937.859,1722.41C1367.8,1722.41 1716.86,1363.84 1716.86,922.172C1716.86,480.508 1367.8,121.933 937.859,121.933C770.622,121.933 615.622,176.187 488.644,268.48Z" style="fill:white;"/>
            </g>
            <g>
                <g transform="matrix(1.51159,0,0,1.51159,-367.876,-361.387)">
                    <path d="M818.993,840.627C799.832,880.751 758.867,908.5 711.472,908.5C645.75,908.5 592.392,855.142 592.392,789.42C592.392,723.699 645.75,670.341 711.472,670.341C758.867,670.341 799.832,698.09 818.993,738.214L788.639,738.214C772.039,713.261 743.662,696.803 711.472,696.803C660.355,696.803 618.855,738.304 618.855,789.42C618.855,840.537 660.355,882.038 711.472,882.038C743.662,882.038 772.039,865.58 788.639,840.627L818.993,840.627Z" style="fill:white;"/>
                </g>
                <g transform="matrix(1.06695,0,0,1.01253,-72.1946,-11.6306)">
                    <path d="M1081.86,1000.99L986.444,1000.99C943.425,1000.99 908.5,964.184 908.5,918.853L908.5,665.194L945.99,665.194L945.99,914.865C945.99,940.594 965.813,961.482 990.228,961.482L1081.86,961.482L1081.86,1000.99Z" style="fill:white;"/>
                </g>
                <g transform="matrix(1.06695,0,0,1.01253,132.023,-11.6306)">
                    <path d="M945.99,847.558L945.99,914.865C945.99,940.594 965.813,961.482 990.228,961.482L1081.86,961.482L1081.86,1000.99L986.444,1000.99C943.425,1000.99 908.5,964.184 908.5,918.853L908.5,747.327C908.5,701.996 943.425,665.194 986.444,665.194L1081.86,665.194L1081.86,704.699L990.228,704.699C965.813,704.699 945.99,725.587 945.99,751.315L945.99,812.991L1047.98,812.991L1047.98,847.558L945.99,847.558Z" style="fill:white;"/>
                </g>
                <g transform="matrix(1.06695,0,0,1.01253,360.193,-11.6306)">
                    <path d="M945.99,847.558L945.99,1067.16L908.5,1071.15L908.5,747.327C908.5,701.996 943.425,665.194 986.444,665.194L1081.86,665.194L1081.86,704.699L990.228,704.699C965.813,704.699 945.99,725.587 945.99,751.315L945.99,812.991L1047.98,812.991L1047.98,847.558L945.99,847.558Z" style="fill:white;"/>
                </g>
                <g transform="matrix(1.10119,0,0,1.10119,-115.327,-101.03)">
                    <path d="M1334.15,1045.56C1367.98,1045.56 1395.44,1073.02 1395.44,1106.85C1395.44,1140.68 1367.98,1168.15 1334.15,1168.15C1300.32,1168.15 1272.85,1140.68 1272.85,1106.85C1272.85,1073.02 1300.32,1045.56 1334.15,1045.56ZM1334.15,1073.7C1315.85,1073.7 1301,1088.56 1301,1106.85C1301,1125.15 1315.85,1140 1334.15,1140C1352.44,1140 1367.3,1125.15 1367.3,1106.85C1367.3,1088.56 1352.44,1073.7 1334.15,1073.7Z" style="fill:white;"/>
                </g>
                <g transform="matrix(0.407847,0,0,0.407847,837.749,589.883)">
                    <path d="M1334.15,1045.56C1367.98,1045.56 1395.44,1073.02 1395.44,1106.85C1395.44,1140.68 1367.98,1168.15 1334.15,1168.15C1300.32,1168.15 1272.85,1140.68 1272.85,1106.85C1272.85,1073.02 1300.32,1045.56 1334.15,1045.56ZM1334.15,1079.4C1319,1079.4 1306.7,1091.7 1306.7,1106.85C1306.7,1122 1319,1134.3 1334.15,1134.3C1349.3,1134.3 1361.6,1122 1361.6,1106.85C1361.6,1091.7 1349.3,1079.4 1334.15,1079.4Z" style="fill:white;"/>
                </g>
            </g>
            <g transform="matrix(1.03206,0,0,0.793957,-16.9132,243.372)">
                <rect x="536.06" y="1098.86" width="7.122" height="86.655" style="fill:white;fill-rule:nonzero;"/>
                <path d="M585.33,1185.52L585.33,1098.86L590.369,1098.86L592.452,1109.82L592.452,1185.52L585.33,1185.52ZM631.452,1185.52L589.351,1111.21L590.369,1098.86L632.469,1173.17L631.452,1185.52ZM631.452,1185.52L629.368,1175.13L629.368,1098.86L636.49,1098.86L636.49,1185.52L631.452,1185.52Z" style="fill:white;fill-rule:nonzero;"/>
                <rect x="678.639" y="1098.86" width="7.122" height="86.655" style="fill:white;fill-rule:nonzero;"/>
                <path d="M746.464,1185.52L746.464,1101.32L753.586,1101.32L753.586,1185.52L746.464,1185.52ZM728.757,1107.3L728.757,1098.86L771.293,1098.86L771.293,1107.3L728.757,1107.3Z" style="fill:white;fill-rule:nonzero;"/>
                <rect x="814.29" y="1098.86" width="7.122" height="86.655" style="fill:white;fill-rule:nonzero;"/>
                <path d="M858.667,1185.52L885.943,1098.86L891.272,1098.86L918.354,1185.52L910.651,1185.52L887.154,1109L889.916,1109L866.225,1185.52L858.667,1185.52ZM871.118,1162.97L871.118,1154.85L906,1154.85L906,1162.97L871.118,1162.97Z" style="fill:white;fill-rule:nonzero;"/>
                <path d="M963.894,1185.52L963.894,1101.32L971.016,1101.32L971.016,1185.52L963.894,1185.52ZM946.187,1107.3L946.187,1098.86L988.723,1098.86L988.723,1107.3L946.187,1107.3Z" style="fill:white;fill-rule:nonzero;"/>
                <rect x="1031.72" y="1098.86" width="7.122" height="86.655" style="fill:white;fill-rule:nonzero;"/>
                <path d="M1102.65,1185.52L1076.1,1098.86L1083.85,1098.86L1106.81,1175.32L1103.95,1175.32L1127.11,1098.86L1134.72,1098.86L1107.98,1185.52L1102.65,1185.52Z" style="fill:white;fill-rule:nonzero;"/>
                <path d="M1215.87,1185.52L1187.36,1185.52C1183.28,1185.52 1179.36,1183.41 1176.48,1179.66C1173.59,1175.91 1171.97,1170.82 1171.97,1165.52C1171.97,1151.5 1171.97,1132.82 1171.97,1118.81C1171.97,1107.79 1178.84,1098.86 1187.32,1098.86C1199.79,1098.86 1215.33,1098.86 1215.33,1098.86L1215.33,1107.3L1189.02,1107.3C1183.54,1107.3 1179.1,1113.08 1179.1,1120.2C1179.1,1128.25 1179.1,1137.09 1179.1,1137.09L1208.05,1137.09L1208.05,1145.21L1179.1,1145.21L1179.1,1164.18C1179.1,1167.6 1180.14,1170.88 1182,1173.3C1183.86,1175.72 1186.39,1177.08 1189.02,1177.08C1199.91,1177.08 1215.87,1177.08 1215.87,1177.08L1215.87,1185.52Z" style="fill:white;"/>
            </g>
        </g>
      </svg>
    </div>
    <!-- Element 3: Main Navigation -->
    <div class="flex-1">
      {{ if .Site.Menus.main }}
      <nav class="flex flex-col gap-4" aria-label="Footer navigation">
        {{ range .Site.Menus.main }}
        <a
                href="{{ .URL }}"
                class="text-sm text-{{ $gray }}-600 dark:text-{{ $gray }}-400 hover:text-{{ $gray }}-900 dark:hover:text-{{ $gray }}-100 transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500"
                {{ if strings.HasPrefix .URL "http" }}target="_blank" rel="noopener noreferrer"{{ end }}
        >
        {{ .Name }}
        </a>
        {{ end }}
      </nav>
      {{ end }}
    </div>
    <!-- Element 4: Footer Navigation -->
    <div class="flex-1">
      {{ if .Site.Menus.footer }}
      <nav class="flex flex-col gap-4" aria-label="Footer navigation">
        {{ range .Site.Menus.footer }}
        <a
                href="{{ .URL }}"
                class="text-sm text-{{ $gray }}-600 dark:text-{{ $gray }}-400 hover:text-{{ $gray }}-900 dark:hover:text-{{ $gray }}-100 transition-colors focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500"
                {{ if strings.HasPrefix .URL "http" }}target="_blank" rel="noopener noreferrer"{{ end }}
        >
        {{ .Name }}
        </a>
        {{ end }}
      </nav>
      {{ end }}
    </div>
  </div>
  <div class="md:max-w-2xl max-w-full mx-auto py-2 flex flex-row justify-between items-center gap-4 mt-8">
    <!-- Element 1: Dark mode toggle -->
    <span class="text-sm text-{{ $gray }}-400">Â© {{ with .Site.Copyright }}{{ . | markdownify}}{{ end }}</span>
    <a
      onclick="toggleTheme()"
      class="
        p-3
        flex-none
        rounded-xl
        text-{{ $gray }}-600 dark:text-{{ $gray }}-400 hover:text-{{ $gray }}-900 dark:hover:text-{{ $gray }}-100
        hover:bg-{{ $gray }}-50 dark:hover:bg-{{ $gray }}-800 transition-colors
        focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-500"
      role="button"
      aria-label="Toggle dark mode"
      title="Toggle dark/light mode"
      id="theme-toggle"
    >
      <!-- Sun icon (shown in dark mode) -->
      <svg class="size-5 hidden dark:block" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="5"/>
        <path d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4"/>
      </svg>
      <!-- Moon icon (shown in light mode) -->
      <svg class="size-5 block dark:hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>
    </a>
  </div>
</footer>

<!-- Dark mode toggle JS -->
<script>
    function initTheme() {
        // Apply theme on load to avoid FOUC
        const isDark = localStorage.theme === 'dark' ||
            (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);

        document.documentElement.classList.toggle('dark', isDark);
    }

    function toggleTheme() {
        const html = document.documentElement;
        const isDark = html.classList.contains('dark');

        if (isDark) {
            // Switch to light mode
            html.classList.remove('dark');
            localStorage.theme = 'light';
        } else {
            // Switch to dark mode
            html.classList.add('dark');
            localStorage.theme = 'dark';
        }

        // Force a repaint to ensure icon changes are visible
        document.getElementById('theme-toggle').offsetHeight;
    }

    // Initialize theme on page load
    document.addEventListener('DOMContentLoaded', initTheme);

    // Also run immediately in case DOMContentLoaded already fired
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initTheme);
    } else {
        initTheme();
    }
</script>
